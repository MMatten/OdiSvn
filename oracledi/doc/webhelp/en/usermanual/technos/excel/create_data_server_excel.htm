<!doctype HTML public "-//W3C//DTD HTML 4.0 Frameset//EN">

<html>

<head>
<title>Creating a Microsoft Excel Data Server</title>
<meta http-equiv="content-type" content="text/html; charset=windows-1252">
<meta name="generator" content="RoboHelp by eHelp Corporation www.ehelp.com">
<link rel="stylesheet" href="../../../include/common_ns.css"><script type="text/javascript" language="JavaScript" title="WebHelpSplitCss">
<!--
if (navigator.appName !="Netscape")
{   document.write("<link rel='stylesheet' href='../../../include/common.css'>");}
//-->
</script>
<style type="text/css">
<!--
ol.whs1 { list-style:decimal; }
ul.whs2 { list-style:disc; }
p.whs3 { margin-left:0px; }
-->
</style><script type="text/javascript" language="JavaScript">
<!--
if ((navigator.appName == "Netscape") && (parseInt(navigator.appVersion) == 4))
{
  var strNSS = "<style type='text/css'>";
  strNSS += "p.whs3 {margin-left:1pt; }";
  strNSS +="</style>";
  document.write(strNSS);
}
//-->
</script>
<script type="text/javascript" language="JavaScript" title="WebHelpInlineScript">
<!--
function reDo() {
  if (innerWidth != origWidth || innerHeight != origHeight)
     location.reload();
}
if ((parseInt(navigator.appVersion) == 4) && (navigator.appName == "Netscape")) {
	origWidth = innerWidth;
	origHeight = innerHeight;
	onresize = reDo;
}
onerror = null; 
//-->
</script>
<style type="text/css">
<!--
div.WebHelpPopupMenu { position:absolute; left:0px; top:0px; z-index:4; visibility:hidden; }
-->
</style><script type="text/javascript" language="javascript1.2" src="../../../whtopic.js"></script>
<script type="text/javascript" language="javascript1.2" src="../../../whutils.js"></script>
<script type="text/javascript" language="javascript" src="../../../whver.js"></script>
<script  type="text/javascript" language="javascript1.2">
    <!--
    var linkedScrollbarStyle = "<link rel='stylesheet' href='../../../wf_topics.css'>";
    if( (!isTopicOnly()) &&(parent.gbFHPureHtml == null) )
    {
        document.write(linkedScrollbarStyle);
    }
    //-->
</script>
</head>
<body><script type="text/javascript" language="javascript1.2">
<!--
if (window.addTocInfo)
{
addTocInfo("User's Guide\nUsing Oracle Data Integrator with ...\nExcel\nCreating a Microsoft Excel Data Server");

  addShowButton();
}
if (window.setRelStartPage)
{
setRelStartPage("../../../index.htm");

	sendTopicLoaded();
	autoSync(1);
	sendSyncInfo();
	sendAveInfo();
	sendBgColorInfo();
}
//-->
</script>
<h1>Creating a Microsoft Excel Data Server</h1>

<p>A Microsoft Excel <span class=ElementGUI>Data Server </span>corresponds 
 to one Microsoft Excel spreadsheet that is accessible through your local 
 network. </p>

<h2>Pre-requisites</h2>

<h3>ODBC Configuration</h3>

<p>Microsoft Excel spreadsheets can only be accessed through ODBC connectivity. 
 A proper ODBC data source must be defined with the Microsoft ODBC Data 
 Source Administrator. </p>

<h4>Declaring a new ODBC Data Source</h4>

<p>To declare a new ODBC data source, run the <span class=ElementGUI>Microsoft 
 ODBC Data Source Administrator</span> from the <span class=ElementGUI>Configuration 
 Panel</span>, then follow these steps: </p>

<ol type="1" class="whs1">
	
	<li class=kadov-p><p>Click the <span class=ElementGUI>Add</span> button 
 to add a new Data source</p></li>
	
	<li class=kadov-p><p>Select the appropriate driver for Microsoft Excel: 
 <span class=Code>Microsoft Excel Driver (*.xls)</span> and click <span 
 class=ElementGUI>Finish</span></p></li>
	
	<li class=kadov-p><p>Name this data source (this will be the &quot;alias&quot; 
 that you need in Topology), and select the appropriate spreadsheet with 
 the <span class=ElementGUI>Select Workbook...</span> button</p></li>
	
	<li class=kadov-p><p>In the <span class=ElementGUI>Options</span> uncheck 
 the <span class=ElementGUI>Read Only</span> checkbox if you wish to write 
 to the Excel spreadsheet</p></li>
	
	<li class=kadov-p><p>Click <span class=ElementGUI>OK</span></p></li>
</ol>

<h3>Excel spreadsheet Configuration</h3>

A single Excel spreadsheet can contain several pages, and each page can 
 contain several tables. Oracle Data Integrator should be able to locate each 
 table, regardless of how the spreadsheet is organized. Oracle Data Integrator 
 will identify the tables by their name. To name a table, you just have 
 to follow these steps: 

<ol type="1" class="whs1">
	
	<li class=kadov-p><p>Open the spreadsheet in Microsoft Excel</p></li>
	
	<li class=kadov-p><p>Select all of the cells in the table</p></li>
	
	<li class=kadov-p><p>From the menu, select <span class=ElementGUI>Insert 
 </span>&gt; <span class=ElementGUI>Name </span>&gt; <span class=ElementGUI>Define 
 ...</span></p></li>
	
	<li class=kadov-p><p>Enter a name for that table, and click <span class=ElementGUI>OK</span>. 
 This name will appear as the datastore name when you reverse engineer 
 the Excel Spreadsheet in Oracle Data Integrator.</p></li>
</ol>

<p class=Remarque><span class=RemarqueTitre>Note</span>: The first line 
 of the table will correspond to the header line in which Oracle Data Integrator 
 will fetch the column names during the reverse-engineering process.</p>

<p class=Remarque><span class=RemarqueTitre>Note</span>: If you want to 
 define an empty table, select only the first line in the naming process. 
 Oracle Data Integrator will automatically add the new lines below this one when 
 inserting data.</p>

<h2>Creation of the Data Server</h2>

<h6>To create a Microsoft Excel Data Server:</h6>

<ol type="1" class="whs1">
	
	<li class=kadov-p><p>Connect to <span class=ElementGUI>Topology Manager</span></p></li>
	
	<li class=kadov-p><p>Select <span class=ElementGUI>Topology</span> 
 &gt; <span class=ElementGUI>Physical Architecture </span>&gt; <span class=ElementGUI>Technologies</span> 
 &gt; <span class=ElementGUI>Microsoft Excel </span>in the tree</p></li>
	
	<li class=kadov-p><p>Right click and select <span class=ElementGUI>Insert 
 Data Server</span></p></li>
	
	<li class=kadov-p><p>Fill in the following fields in the <span class=ElementGUI>Definition</span> 
 tab:</p></li>
	
	<ul type="disc" class="whs2">
		
		<li class=kadov-p><p class="whs3"><span class=ElementGUI>Name</span>: 
 Name of the Data Server that will appear in Oracle Data Integrator.</p></li>
		
		<li class=kadov-p><p class="whs3"><span class=ElementGUI>User/Password:</span> 
 Not used here.</p></li>
		
		<li class=kadov-p><p class="whs3"><span class=ElementGUI>Batch 
 update</span> : 1</p></li>
		
		<li class=kadov-p><p class="whs3"><span class=ElementGUI>Array 
 Fetch</span> : 1</p></li>
	</ul>
	
	<li class=kadov-p><p>Fill in the following fields in the <span class=ElementGUI>JDBC</span> 
 tab:</p></li>
</ol>

<ol type="1" class="whs1">
	
	<ul>
		
		<li style="list-style: disc;"
			type=disc
			class=kadov-p><p class="whs3"><span class=ElementGUI>JDBC 
 Driver</span>: <span class=Code>sun.jdbc.odbc.JdbcOdbcDriver</span></p></li>
		
		<li style="list-style: disc;"
			type=disc
			class=kadov-p><p class="whs3"><span class=ElementGUI>JDBC 
 URL</span>: <span class=Code>jdbc:odbc:&lt;AliasName&gt;</span></p></li>
		
		where <b>&lt;AliasName&gt;</b> is the name of your ODBC data source. 
 &nbsp; 
	</ul>
</ol>

<p class=Remarque><b style="font-weight: bold;"><span class=AlertTitre>Warning</b>:</span> 
 to access a Microsoft Excel Spreadsheet via ODBC, you must first ensure 
 that this spreadsheet is not currently open in a Microsoft Excel session. 
 This can lead to unexpected results. <br>&nbsp;</p>

<ol start="6" type="1" class="whs1">
	
	<li class=kadov-p><p>Click <span class=ElementGUI>Test</span>.</p></li>
	
	<li class=kadov-p><p>Click <span class=ElementGUI>Test </span>in the 
 <span class=ElementGUI>Test Connection</span> windows.</p></li>
	
	<li class=kadov-p><p>A windows indicating a <span class=ElementGUI>Successful 
 Connection </span>appears. Click <span class=ElementGUI>OK</span>. If 
 the connection is not successful, refer to the <a HREF="errors_excel.htm">Common 
 Errors with Microsoft Excel</a>.</p></li>
	
	<li class=kadov-p><p>Click <span class=ElementGUI>OK</span> to validate 
 the creation of the data server</p></li>
</ol>

<p>The creation window for the data server's first <span class=ElementGUI>Physical 
 Schema </span>appears.<br>
See <a href="create_pchema_excel.htm">Create a Microsoft Excel Physical 
 Schema</a></p>

</body>
</html>
